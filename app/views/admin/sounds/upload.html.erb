<button id="upload_mp3" class="cloudinary-button">Upload mp3</button>
<button id="upload_poster" class="cloudinary-button">Upload image</button>

<script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>



<script type="text/javascript">  
	var mp3_widget = cloudinary.createUploadWidget({ 
		cloudName: "dvhymcfm3", uploadPreset: "msg2xcck", folder: "radio_ulis/audio" }, (error, result) => { 

			if (result.info.url != null) {
				//updateSoundSource(result.info.url);
			}
		});


	document.getElementById("upload_mp3").addEventListener("click", function(){
		mp3_widget.open();
	}, false);

	var poster_widget = cloudinary.createUploadWidget({ 
		cloudName: "dvhymcfm3", uploadPreset: "msg2xcck", folder: "radio_ulis/poster" }, (error, result) => { 

			if (result.info.url != null) {

				//var myform = document.getElementById("myform");

				//(result.info.url);
			}
		});


	document.getElementById("upload_poster").addEventListener("click", function(){
		poster_widget.open();
	}, false);

	$('.cloudinary-fileupload').bind('cloudinarydone', function(e, data) {  
  $('.preview').html(
    $.cloudinary.image(data.result.public_id, 
      { format: data.result.format, version: data.result.version, 
        crop: 'fill', width: 150, height: 100 })
  );    
  $('.image_public_id').val(data.result.public_id);    
  return true;
});


	function updateSoundSource(url) {

		var fd = new FormData();
		fd.append('source', url);
		$.ajax({
			type: "PUT",
			url: "/sounds/#{params[:id]}",
			data: fd
		});

	}

	function updateSoundPoster(url) {

		var fd = new FormData();
		fd.append('poster', url);
		$.ajax({
			type: "PUT",
			url: "/sounds/#{params[:id]}",
			data: fd
		});

	}

	function testUpload(url) {


		$.ajax({
			type: "POST",
			url: "/sounds/34",
			success: function(data) {
				console.log(data);
			}
		});
	}


</script>


